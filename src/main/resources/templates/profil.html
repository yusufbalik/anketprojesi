<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Profilim | Anket Dünyası</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        body { background: #f8fafc; font-family: 'Inter', sans-serif; }
        .container-main { max-width: 950px; margin: 40px auto; padding: 20px; }
        
        /* Profil Header */
        .profile-header {
            background: white; border-radius: 20px; padding: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05); display: flex; align-items: center; gap: 30px; margin-bottom: 30px;
            border: 1px solid #e2e8f0; position: relative; overflow: hidden;
        }
        .profile-header::after {
            content: ''; position: absolute; right: -20px; top: -20px; width: 150px; height: 150px;
            background: linear-gradient(135deg, rgba(249, 115, 22, 0.1), rgba(251, 191, 36, 0.1));
            border-radius: 50%; z-index: 0;
        }

        .avatar-box {
            width: 100px; height: 100px; background: #f1f5f9; border-radius: 25px;
            display: flex; align-items: center; justify-content: center;
            font-size: 40px; color: #64748b; position: relative; z-index: 1;
        }
        .user-info { position: relative; z-index: 1; flex-grow: 1; }
        .user-info h1 { font-size: 26px; font-weight: 800; color: #0f172a; margin: 0 0 5px 0; }
        
        .badge-role { padding: 6px 14px; border-radius: 20px; font-size: 11px; font-weight: 800; display: inline-flex; align-items: center; gap: 6px; letter-spacing: 0.5px; text-transform: uppercase; }
        .bg-premium { background: linear-gradient(135deg, #F2C94C, #F2994A); color: white; box-shadow: 0 4px 10px rgba(242, 153, 74, 0.3); }
        .bg-admin { background: linear-gradient(135deg, #ef4444, #be123c); color: white; }
        .bg-standard { background: #e2e8f0; color: #64748b; }

        /* XP ve Rütbe Alanları */
        .rank-section { margin-bottom: 40px; }
        .section-title { font-size: 16px; font-weight: 800; color: #334155; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; }
        
        .rank-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
        
        .rank-card {
            background: white; border: 1px solid #e2e8f0; border-radius: 16px; padding: 20px;
            text-align: center; position: relative; transition: 0.3s; overflow: hidden;
        }
        .rank-card.locked { opacity: 0.6; background: #f8fafc; border-style: dashed; }
        .rank-card.locked .rank-icon { color: #cbd5e1; filter: grayscale(100%); }
        .rank-card.locked .lock-overlay { 
            display: flex; align-items: center; justify-content: center;
            position: absolute; top: 10px; right: 10px; color: #94a3b8; font-size: 14px;
        }
        .rank-card.unlocked { border-color: #3b82f6; box-shadow: 0 4px 15px rgba(59, 130, 246, 0.1); }
        .rank-card.unlocked .lock-overlay { display: none; }
        .rank-card.current { 
            border: 2px solid #f97316; transform: translateY(-5px); 
            box-shadow: 0 10px 25px rgba(249, 115, 22, 0.2); 
        }
        .rank-card.current::before {
            content: 'MEVCUT'; position: absolute; top: 0; left: 50%; transform: translateX(-50%);
            background: #f97316; color: white; font-size: 9px; font-weight: 800; padding: 2px 8px; border-radius: 0 0 6px 6px;
        }

        .rank-icon { font-size: 32px; margin-bottom: 10px; display: inline-block; }
        .rank-name { font-weight: 800; font-size: 14px; color: #0f172a; margin-bottom: 2px; }
        .rank-xp { font-size: 11px; font-weight: 600; color: #64748b; background: #f1f5f9; padding: 4px 10px; border-radius: 10px; display: inline-block; }

        /* Anket Listesi */
        .anket-list { background: white; border-radius: 16px; border: 1px solid #e2e8f0; overflow: hidden; }
        .anket-item { padding: 18px 25px; border-bottom: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center; transition: 0.2s; }
        .anket-item:hover { background: #f8fafc; }
        .btn-delete { width: 32px; height: 32px; border-radius: 8px; background: #fee2e2; color: #ef4444; display: flex; align-items: center; justify-content: center; transition: 0.2s; }
        .btn-delete:hover { background: #fecaca; }
        
        .back-btn { display: inline-flex; align-items: center; gap: 8px; color: #64748b; text-decoration: none; font-weight: 600; margin-bottom: 20px; font-size: 14px; }
        .back-btn:hover { color: #0f172a; }
        
        /* XP Barı */
        .xp-wrapper-header { margin-top: 15px; max-width: 350px; }
        .xp-bar-bg { width: 100%; height: 8px; background: #e2e8f0; border-radius: 10px; overflow: hidden; }
        .xp-bar-fill { height: 100%; border-radius: 10px; transition: width 1s ease; }
        
        /* ADMIN ÖZEL KUTUSU */
        .admin-status-box {
            margin-top: 15px;
            background: rgba(239, 68, 68, 0.05); color: #ef4444; 
            padding: 12px 20px; border-radius: 12px; font-size: 13px; font-weight: 700; 
            border: 1px solid rgba(239, 68, 68, 0.2); display: inline-flex; align-items: center; gap: 10px;
        }
    </style>
</head>
<body>

<div class="container-main">
    <a href="/" class="back-btn"><i class="fa-solid fa-arrow-left"></i> Anasayfaya Dön</a>

    <div class="profile-header">
        <div class="avatar-box">
            <i th:if="${isAdmin}" class="fa-solid fa-user-shield"></i>
            <i th:if="${isPremium and !isAdmin}" class="fa-solid fa-crown" style="color: #F2994A;"></i>
            <i th:if="${!isPremium and !isAdmin}" class="fa-solid fa-user-astronaut"></i>
        </div>
        <div class="user-info">
            <div style="display: flex; align-items: center; gap: 10px;">
                <h1 th:text="${kullaniciAdi}">Kullanıcı</h1>
                <span th:if="${isAdmin}" class="badge-role bg-admin">YÖNETİCİ</span>
                <span th:if="${isPremium and !isAdmin}" class="badge-role bg-premium">PREMIUM</span>
                <span th:if="${!isPremium and !isAdmin}" class="badge-role bg-standard">ÜYE</span>
            </div>
            
            <div th:if="${isAdmin}" class="admin-status-box">
                <i class="fa-solid fa-shield-halved"></i>
                <span>Sistem Yöneticisi - Tam Erişim Yetkisi</span>
            </div>

            <div th:if="${!isAdmin}" class="xp-wrapper-header">
                <div style="display: flex; justify-content: space-between; font-size: 12px; font-weight: 700; color: #64748b; margin-bottom: 5px;">
                    <span th:text="${kullaniciRutbe}">Çaylak</span>
                    <span th:text="${kullaniciPuan} + ' XP'">0 XP</span>
                </div>
                <div class="xp-bar-bg">
                    <div class="xp-bar-fill" th:style="'width:' + (${kullaniciPuan} > 500 ? 100 : (${kullaniciPuan} * 100 / 500)) + '%; background:' + ${kullaniciRutbeRenk}"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="rank-section" th:if="${!isAdmin}">
        <div class="section-title">
            <span><i class="fa-solid fa-trophy" style="color: #f59e0b; margin-right: 8px;"></i> Rütbe Yolculuğu</span>
            <span style="font-size: 12px; color: #94a3b8; font-weight: 500;">Her etkileşimde XP kazan!</span>
        </div>
        
        <div class="rank-grid">
            <div class="rank-card" 
                 th:classappend="${kullaniciPuan >= 0} ? (${kullaniciPuan < 50} ? 'unlocked current' : 'unlocked') : 'locked'">
                <div class="lock-overlay"><i class="fa-solid fa-lock"></i></div>
                <div class="rank-icon" style="color: #64748b;"><i class="fa-solid fa-seedling"></i></div>
                <div class="rank-name">Çaylak</div>
                <div class="rank-xp">0 - 49 XP</div>
            </div>

            <div class="rank-card" 
                 th:classappend="${kullaniciPuan >= 50} ? (${kullaniciPuan < 200} ? 'unlocked current' : 'unlocked') : 'locked'">
                <div class="lock-overlay"><i class="fa-solid fa-lock"></i></div>
                <div class="rank-icon" style="color: #3b82f6;"><i class="fa-solid fa-medal"></i></div>
                <div class="rank-name">Deneyimli</div>
                <div class="rank-xp">50 XP +</div>
            </div>

            <div class="rank-card" 
                 th:classappend="${kullaniciPuan >= 200} ? (${kullaniciPuan < 500} ? 'unlocked current' : 'unlocked') : 'locked'">
                <div class="lock-overlay"><i class="fa-solid fa-lock"></i></div>
                <div class="rank-icon" style="color: #f59e0b;"><i class="fa-solid fa-star"></i></div>
                <div class="rank-name">Usta</div>
                <div class="rank-xp">200 XP +</div>
            </div>

            <div class="rank-card" 
                 th:classappend="${kullaniciPuan >= 500} ? 'unlocked current' : 'locked'">
                <div class="lock-overlay"><i class="fa-solid fa-lock"></i></div>
                <div class="rank-icon" style="background: linear-gradient(135deg, #06b6d4, #3b82f6); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                    <i class="fa-solid fa-gem"></i>
                </div>
                <div class="rank-name">Titanium Üstadı</div>
                <div class="rank-xp">500 XP +</div>
            </div>
        </div>
    </div>

    <div class="section-title" style="margin-top: 30px;">Oluşturduğum Anketler</div>
    <div class="anket-list">
        <div th:if="${benimAnketlerim == null or benimAnketlerim.empty}" style="padding: 40px; text-align: center; color: #94a3b8;">
            <i class="fa-regular fa-folder-open fa-2x mb-3"></i>
            <p>Henüz hiç anket oluşturmadınız.</p>
            <a href="/yeni-anket" style="color: #f97316; font-weight: 600; text-decoration: none;">Hemen Bir Tane Oluştur!</a>
        </div>

        <div class="anket-item" th:each="anket : ${benimAnketlerim}">
            <div class="anket-info">
                <h3 th:text="${anket.baslik}" style="margin: 0 0 5px 0; font-size: 15px; font-weight: 700; color: #1e293b;">Başlık</h3>
                <div style="font-size: 12px; color: #94a3b8;">
                    <span th:text="${anket.kategori}">Genel</span> • 
                    <span th:text="${anket.toplamOy} + ' Oy'">0 Oy</span>
                </div>
            </div>
            <a th:href="@{/anket-sil/{id}(id=${anket.id})}" 
               onclick="return confirm('Bu anketi silmek istediğine emin misin?');"
               class="btn-delete"><i class="fa-solid fa-trash"></i></a>
        </div>
    </div>
</div>

</body>
</html>